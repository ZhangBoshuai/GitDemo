<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="../js/jquery-3.3.1.min.js"></script>
    <script src="../js/form2json.js"></script>
    <script>
        $(function () {
            findAllCollege()
            findByMajor()
        })

        function findByMajor() {
            var href = location.href;
            var strings = href.split("=");
            var majorId = strings[1];
            $.ajax({
                url: "/major/findByMajor/" + majorId,
                type: "get",
                dataType: "json",
                statusCode: {
                    200: function (ele) {
                        $("#majorId").val(ele.majorId)
                        $("#majorName").val(ele.majorName)
                        $("#collegeCid").val(ele.collegeCid)
                        $("#majorDescribe").html(ele.majorDescribe);
                    },
                    500: function () {
                    }
                }
            })
        }

        function findAllCollege() {
            $.ajax({
                url: "/college/findAllCollege",
                type: "get",
                dataType: "json",
                statusCode: {
                    200: function (ele) {
                        $("#collegeCid").html("")
                        $(ele).each(function (i, data) {
                            $("#collegeCid").append("<option value=\"" + data.collegeId + "\">" + data.collegeName + "</option>")
                        })
                    },
                    500: function () {
                    }
                }
            })
        }

        function mysubmit() {
            var formToJson = $("#addForm").formToJson();
            $.ajax({
                url: "/major/updateByMajor",
                type: "put",
                data: formToJson,
                statusCode: {
                    205: function () {
                        location.href = "majorlist.html"
                    },
                    500: function () {
                        $("#s01").html("更新失败")
                    }
                }
            })
        }
    </script>
</head>
<body>
<form id="addForm">
    <input type="hidden" id="majorId" name="majorId">
    专业名称:<input type="text" id="majorName" name="majorName" placeholder="请输入"><br>
    设立学院:<select name="collegeCid" id="collegeCid">
    <option value="1">计算机工程学院</option>
    <option value="2">大数据工程学院</option>
</select>
    <br>
    专业描述:<textarea id="majorDescribe" name="majorDescribe" placeholder="请输入内容"></textarea><br>
    <input type="button" id="add" onclick="mysubmit()" value="添加"> <input type="reset" name="button" id="caln"
                                                                          value="重置"/>
    <span id="s01"></span>
</form>
</body>
</html>