<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--jquery-->
    <script src="../js/jquery-3.3.1.min.js"></script>
    <!--获取form表单-->
    <script src="../js/form2json.js"></script>
    <!--图片上传回显-->
    <script src="../js/imgEcho.js"></script>

    <script>

        $(function () {
            var sid = decodeURI(location.href).split("=")[1]
            $.ajax({
                url: '/student/editShow/' + sid,
                type: 'get',
                dataType: 'json',
                success: function (data) {
                    var s = data.student
                    $("#studentId").val(s.studentId)
                    $("#studentName").val(s.studentName)
                    if ($("#man").val() == s.studentSex) {
                        $("#man").prop("checked", true)
                    } else {
                        $("#woman").prop("checked", true)
                    }
                    $("#studentPhone").val(s.studentPhone)
                    $("#studentBirthday").val(s.studentBirthday)
                    $("#studentEmail").val(s.studentEmail)
                    $("#studentDescribe").val(s.studentDescribe)
                    $("#studentYear").val(s.studentYear)
                    $("#studentSemester").val(s.studentSemester)

                    var majors = data.majorList
                    $(majors).each(function (index, ele) {
                        if (s.majorId == ele.majorId) {
                            $("#majorSeId").append("<option selected='selected' value='"+ele.majorId+"'>"+ele.majorName+"</option>")
                        }else {
                            $("#majorSeId").append("<option   value='"+ele.majorId+"'>"+ele.majorName+"</option>")
                        }
                    })
                }
            })
        })

        function mySubmit() {
            var ft=$("#editForm").formToJson()
            $.ajax({
                url:'/student/edit',
                data:ft,
                type:'PUT',
                dataType:'json',
                statusCode:{
                    204:function () {
                        location.href="/html/studentlist.html"
                    },
                    500:function () {
                        alert("修改失败")
                    }
                }
            })
        }

    </script>

</head>
<body>
<h1>编辑学生信息</h1>
<form id="editForm">
    <input type="hidden" name="studentId" id="studentId">
    学生姓名:<input type="text" id="studentName" name="studentName" placeholder="请输入"><br>
    <input type="radio"  id="man" name="studentSex" value="男">男<input type="radio" id="woman" name="studentSex"
                                                                     value="女">女<br>
    联系方式<input type="text" name="studentPhone" id="studentPhone"> 出生日期:<input type="text" id="studentBirthday"
                                                                              name="studentBirthday"><br>
    电子邮箱:<input type="text" name="studentEmail" id="studentEmail"><br>
    所属学年:<input type="text" name="studentYear" id="studentYear"><br>
    所属学期:<input type="text" name="studentSemester" id="studentSemester"><br>
    所属专业:<select name="majorId" id="majorSeId">
    <option value="1">计算器</option>
    <!--<option value="2">大数据</option>-->
</select>
    <br>
    学生描述:<textarea id="studentDescribe" name="studentDescribe" placeholder="请输入内容"></textarea><br>
    <input type="button" id="add" onclick="mySubmit()" value="修改"> <input type="reset" name="button" id="caln"
                                                                          value="重置"/>
</form>


</body>
</html>